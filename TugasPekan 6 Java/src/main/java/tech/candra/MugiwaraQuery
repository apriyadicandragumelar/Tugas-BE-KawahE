package tech.candra;

import tech.candra.models.Mugiwara;

import java.util.List;
import java.util.ArrayList;
import javax.inject.Inject;
import javax.persistence.EntityManager;
import javax.transaction.Transactional;
import javax.validation.Valid;
import javax.ws.rs.GET;
import javax.ws.rs.POST;
import javax.ws.rs.PUT;
import javax.ws.rs.Path;
import javax.ws.rs.PathParam;
import javax.ws.rs.*;


@Path("mugiwara")
// @Produces(MediaType.APPLICATION_JSON)
// @Consumes(MediaType.APPLICATION_JSON)

public class MugiwaraQuery {
    
    @Inject 
    EntityManager en;
   
    @GET 
    //Menampilkan daftar objek secara keseluruhan
    public List<Mugiwara> getMugiwara(){
        List<Mugiwara> mugiwara = en.createNamedQuery("Mugiwara.getAllMugiwara", Mugiwara.class).getResultList();
        return mugiwara;
    }

    @GET 
    @Path ("{id}")
    // Menampilkan Objek dengan id tertentu
    public Mugiwara getMugiwaraById(@PathParam("id") Long kataKunci){
        Mugiwara mugiwaraDenganIdTertentu = en.createNamedQuery("Mugiwara.getMugiwaraById", Mugiwara.class).setParameter("id", kataKunci).getSingleResult();
        return mugiwaraDenganIdTertentu;
    }


    @POST
    @Transactional 
    //Menambahkan data objek baru
    public List<Mugiwara> addMugiwara(@Valid Mugiwara kaizokuMugiwara){
        List<Mugiwara> mugiwara = new ArrayList<>();
        en.persist(kaizokuMugiwara);
        mugiwara = en.createNamedQuery("Mugiwara.getAllMugiwara", Mugiwara.class).getResultList();
        return mugiwara;
    }



    @PUT
    @Path("{id}")
    @Transactional
    //Update data objek baru dengan id tertentu
    public List<Mugiwara> updateMugiwara(@PathParam("id") Long id, @Valid Mugiwara kaizokMugiwara) {
        List<Mugiwara> mugiwara = new ArrayList<>();

        Mugiwara oldMugiwara = en.createNamedQuery("Mugiwara.getMugiwaraById", Mugiwara.class).setParameter("id", id).getSingleResult();
        oldMugiwara.name = kaizokMugiwara.name;
        oldMugiwara.weapon = kaizokMugiwara.weapon;
        oldMugiwara.armor = kaizokMugiwara.armor;
        oldMugiwara.health = kaizokMugiwara.health;
        oldMugiwara.age = kaizokMugiwara.age;
        oldMugiwara.attack = kaizokMugiwara.attack;

        mugiwara = en.createNamedQuery("Mugiwara.getAllMugiwara", Mugiwara.class).getResultList();
        return mugiwara;
    }



    @DELETE 
    @Path("{id}")
    @Transactional
    //Delete data objek dengan id tertentu
    public List<Mugiwara> deleteMugiwara(@PathParam("id") Long id) {
        List<Mugiwara> mugiwara = new ArrayList<>();
        Mugiwara kaizokuMugiwara = en.createNamedQuery("Mugiwara.getMugiwaraById", Mugiwara.class).setParameter("id", id).getSingleResult();
        en.remove(kaizokuMugiwara);

        mugiwara = en.createNamedQuery("Mugiwara.getAllMugiwara", Mugiwara.class).getResultList();
        return mugiwara;
    }
        
}
